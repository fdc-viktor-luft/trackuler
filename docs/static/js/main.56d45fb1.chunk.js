(this["webpackJsonpTrackula-Frontend"]=this["webpackJsonpTrackula-Frontend"]||[]).push([[0],{10:function(e){e.exports=JSON.parse('{"DELETE":"M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z","FOLDER_OPEN":"M572.694 292.093L500.27 416.248A63.997 63.997 0 0 1 444.989 448H45.025c-18.523 0-30.064-20.093-20.731-36.093l72.424-124.155A64 64 0 0 1 152 256h399.964c18.523 0 30.064 20.093 20.73 36.093zM152 224h328v-48c0-26.51-21.49-48-48-48H272l-64-64H48C21.49 64 0 85.49 0 112v278.046l69.077-118.418C86.214 242.25 117.989 224 152 224z","MICROPHONE":"M176 352c53.02 0 96-42.98 96-96V96c0-53.02-42.98-96-96-96S80 42.98 80 96v160c0 53.02 42.98 96 96 96zm160-160h-16c-8.84 0-16 7.16-16 16v48c0 74.8-64.49 134.82-140.79 127.38C96.71 376.89 48 317.11 48 250.3V208c0-8.84-7.16-16-16-16H16c-8.84 0-16 7.16-16 16v40.16c0 89.64 63.97 169.55 152 181.69V464H96c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16h-56v-33.77C285.71 418.47 352 344.9 352 256v-48c0-8.84-7.16-16-16-16z","MICROPHONE_SLASH":"M633.82 458.1l-157.8-121.96C488.61 312.13 496 285.01 496 256v-48c0-8.84-7.16-16-16-16h-16c-8.84 0-16 7.16-16 16v48c0 17.92-3.96 34.8-10.72 50.2l-26.55-20.52c3.1-9.4 5.28-19.22 5.28-29.67V96c0-53.02-42.98-96-96-96s-96 42.98-96 96v45.36L45.47 3.37C38.49-2.05 28.43-.8 23.01 6.18L3.37 31.45C-2.05 38.42-.8 48.47 6.18 53.9l588.36 454.73c6.98 5.43 17.03 4.17 22.46-2.81l19.64-25.27c5.41-6.97 4.16-17.02-2.82-22.45zM400 464h-56v-33.77c11.66-1.6 22.85-4.54 33.67-8.31l-50.11-38.73c-6.71.4-13.41.87-20.35.2-55.85-5.45-98.74-48.63-111.18-101.85L144 241.31v6.85c0 89.64 63.97 169.55 152 181.69V464h-56c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16z","SEARCH":"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z","SETTINGS":"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z","SPINNER":"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z","TIMES":"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"}')},13:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);n(13);var r,c=n(1),a=n.n(c),i=n(6),o=n.n(i),s=n(4),u=n(10),l=n(0),f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.className,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:512;return Object(l.jsx)("svg",{className:n?n+" icon":"icon",viewBox:"0 0 ".concat(r," 512"),children:Object(l.jsx)("path",{fill:"currentColor",d:u[e]})})},d=function(e){return f("DELETE",e,448)},j=function(e){return f("FOLDER_OPEN",e,576)},b=function(e){return f("MICROPHONE",e,352)},p=function(e){return f("MICROPHONE_SLASH",e,640)},h=function(e){return f("SETTINGS",e)},v=function(e){return f("TIMES",e,352)},x=n(5),O=function(e){return Object(x.a)(Object(x.a)({},e),{},{time:e.time.toISOString()})},k=function(e){return("0"+e).slice(-2)},m=function(e){return!!e&&"string"===typeof e},g={uuid:function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)},convertAPITracks:function(e){return e.map((function(e){return Object(x.a)(Object(x.a)({},e),{},{time:new Date(e.time)})}))},convertTracks:function(e){return e.map(O)},toApiString:function(e){return"".concat(e.getFullYear(),"-").concat(k(e.getMonth()+1),"-").concat(k(e.getDate()))},convertTrack:O,getKeyForDate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return"trackuler-"+g.toApiString(e)},classNames:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(m).join(" ")||void 0}},w=n(2),y=n.n(w),S=n(3);!function(e){e.LOCAL="local",e.API="API",e.FILE_SYSTEM="files"}(r||(r={}));var E,L,N=n(7),M=function(){var e=Object(S.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=N.a.get(t))){e.next=8;break}return e.prev=2,e.abrupt("return",JSON.parse(n));case 6:e.prev=6,e.t0=e.catch(2);case 8:return e.abrupt("return",[]);case 9:case"end":return e.stop()}}),e,null,[[2,6]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){return M(g.getKeyForDate())},D={current:function(){return T().then(g.convertAPITracks)},create:function(){var e=Object(S.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T();case 2:(n=e.sent).push(g.convertTrack(t)),N.a.set(g.getKeyForDate(t.time),JSON.stringify(n));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(S.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T();case 2:n=e.sent,N.a.set(g.getKeyForDate(),JSON.stringify(n.filter((function(e){return e.ID!==t}))));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getLatest:function(){var e=g.getKeyForDate();return Promise.all(Object.keys(localStorage).filter((function(t){return t.startsWith("trackuler-2")&&t!==e})).sort().reverse().map((function(e){return M(e).then(g.convertAPITracks)})))}},C={current:function(){return fetch("/api/tracks").then((function(e){return e.ok?e.json().then(g.convertAPITracks):[]}))},create:function(e){var t=e.ID,n=e.description,r=e.time;return fetch("/api/track",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({ID:t,description:n,time:r.toISOString()})}).then((function(e){if(!e.ok)throw new Error("Creation failed")}))},remove:function(e){return fetch("/api/track",{method:"delete",headers:{"Content-Type":"application/json"},body:JSON.stringify({ID:e})}).then((function(e){if(!e.ok)throw new Error("Deletion failed")}))},getLatest:function(){return fetch("/api/tracks/latest").then((function(e){return e.ok?e.json().then((function(e){return e.map(g.convertAPITracks)})):[]}))}},I=n(11),A=n(8);!function(e){e.DIR="directory",e.FILE="file"}(E||(E={})),function(e){e.READ="read",e.READ_WRITE="readwrite"}(L||(L={}));var R="workdir",F={},P={getWorkdir:function(){var e=Object(S.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(F.workdir){e.next=4;break}return e.next=3,Object(A.b)(R);case 3:F.workdir=e.sent;case 4:return e.abrupt("return",F.workdir);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),setWorkdir:function(e){return F.workdir=e,Object(A.c)(R,e)},removeWorkdir:function(){return F.workdir=void 0,Object(A.a)(R)}},W=n(12),z=Object(W.a)({workdirAccessGranted:!1,workdirName:void 0,trackType:void 0,currentKey:g.getKeyForDate()}),H=Object(s.a)(z,2),_=H[0],K=H[1];var J={mode:L.READ_WRITE},Y=/^trackuler-\d{4}-\d{2}-\d{2}\.json$/,V=function(){return e=new Date,g.getKeyForDate(e)+".json";var e},B=function(){var e=Object(S.a)(y.a.mark((function e(t,n){var r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.createWritable();case 2:return r=e.sent,e.next=5,r.write(n);case 5:return e.next=7,r.close();case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),G=function(){var e=Object(S.a)(y.a.mark((function e(t,n){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(t,JSON.stringify(n.map(g.convertTrack)));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),U=function(){var e=Object(S.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P.getWorkdir();case 3:if(!(t=e.sent)){e.next=14;break}return e.next=7,t.queryPermission(J);case 7:if(e.t0=e.sent,"granted"!==e.t0){e.next=10;break}return e.abrupt("return",!0);case 10:return e.next=12,t.requestPermission(J);case 12:return e.t1=e.sent,e.abrupt("return","granted"===e.t1);case 14:e.next=19;break;case 16:e.prev=16,e.t2=e.catch(0),window.console.error(e.t2);case 19:return e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=Object(S.a)(y.a.mark((function e(t){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getFile();case 2:return n=e.sent,e.next=5,n.text();case 5:return r=e.sent,e.abrupt("return",g.convertAPITracks(JSON.parse(r)));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(S.a)(y.a.mark((function e(t){var n,r,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.getWorkdir();case 2:return n=e.sent,e.prev=3,e.next=6,n.getFileHandle(t);case 6:if(!(r=e.sent)){e.next=13;break}return e.t0=r,e.next=11,X(r);case 11:return e.t1=e.sent,e.abrupt("return",{fileHandle:e.t0,tracks:e.t1});case 13:e.next=18;break;case 15:e.prev=15,e.t2=e.catch(3),e.t2.message.includes("could not be found")||window.console.error(e.t2);case 18:return e.next=20,n.getFileHandle(t,{create:!0});case 20:return c=e.sent,e.next=23,G(c,[]);case 23:return e.abrupt("return",{tracks:[],fileHandle:c});case 24:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),$=function(){return q(V())},Q=function(){var e=Object(S.a)(y.a.mark((function e(){var t,n,r,c,a,i,o,s,u,l,f;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=V(),e.next=3,P.getWorkdir();case 3:n=e.sent,r=[],c=!0,a=!1,e.prev=7,o=Object(I.a)(n.values());case 9:return e.next=11,o.next();case 11:return s=e.sent,c=s.done,e.next=15,s.value;case 15:if(u=e.sent,c){e.next=27;break}if((l=u).kind!==E.FILE){e.next=24;break}if(!Y.test(l.name)||l.name===t){e.next=24;break}return e.next=22,X(l);case 22:(f=e.sent).length&&r.push({entry:l,tracks:f});case 24:c=!0,e.next=9;break;case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(7),a=!0,i=e.t0;case 33:if(e.prev=33,e.prev=34,c||null==o.return){e.next=38;break}return e.next=38,o.return();case 38:if(e.prev=38,!a){e.next=41;break}throw i;case 41:return e.finish(38);case 42:return e.finish(33);case 43:return e.abrupt("return",r.sort((function(e,t){return t.entry.name.localeCompare(e.entry.name)})).map((function(e){return e.tracks})));case 44:case"end":return e.stop()}}),e,null,[[7,29,33,43],[34,,38,42]])})));return function(){return e.apply(this,arguments)}}(),Z={init:function(){return U().then((function(e){return K.set({workdirAccessGranted:e})}))},getWorkdir:function(){return P.getWorkdir().then((function(e){return null===e||void 0===e?void 0:e.name}))},current:function(){return q(V()).then((function(e){return e.tracks}))},create:function(){var e=Object(S.a)(y.a.mark((function e(t){var n,r,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$();case 2:return n=e.sent,r=n.tracks,c=n.fileHandle,r.push(t),e.next=8,G(c,r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(S.a)(y.a.mark((function e(t){var n,r,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$();case 2:return n=e.sent,r=n.tracks,c=n.fileHandle,e.next=7,G(c,r.filter((function(e){return e.ID!==t})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getLatest:Q,pickWorkdir:function(){return window.showDirectoryPicker().then(function(){var e=Object(S.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.setWorkdir(t);case 2:return e.abrupt("return",t.name);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch()},unlinkWorkdir:function(){return P.removeWorkdir()}},ee={current:D},te=function(){var e=Object(S.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z.getWorkdir();case 2:if(t=e.sent,K.set({workdirName:t}),!t){e.next=8;break}return e.abrupt("return",r.FILE_SYSTEM);case 8:return e.abrupt("return",r.LOCAL);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=Object(S.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t===r.LOCAL?ee.current=D:t===r.API?ee.current=C:ee.current=Z,K.set({trackType:t});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=Object(S.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.getKeyForDate(),window.addEventListener("focus",(function(){var e=g.getKeyForDate();t!==e&&K.set({currentKey:e})})),e.abrupt("return",te().then(ne));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce={current:function(){return ee.current},change:function(){var e=Object(S.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==r.FILE_SYSTEM){e.next=12;break}return e.next=3,Z.pickWorkdir();case 3:if(!(n=e.sent)){e.next=9;break}K.set({workdirName:n}),ee.current=Z,e.next=10;break;case 9:return e.abrupt("return");case 10:e.next=15;break;case 12:if(ee.current!==Z){e.next=15;break}return e.next=15,Z.unlinkWorkdir();case 15:return e.next=17,ne(t);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),toReadableTimeDiff:function(e){var t=Math.floor(e/1e3),n=Math.floor(t/60),r=Math.floor(n/60),c=n%60,a=t%60,i=[];return r&&i.push(r+"h"),c&&i.push(c+"m"),a&&i.push(a+"s"),i.join(" ")},toRate:function(e){return e/288e5},init:re};window.SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition;var ae,ie={running:!1,locale:navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language,start:function(){},stop:function(){}},oe=function(){var e=new SpeechRecognition;return e.continuous=!1,e.lang=ie.locale,e.interimResults=!1,e.maxAlternatives=1,ie.start=function(){ie.running||(e.start(),ie.running=!0)},ie.stop=function(){ie.running&&e.stop()},e.onend=function(){ie.running=!1},e.onspeechend=function(){ie.stop()},e.onerror=function(e){window.console.error("Error occurred in recognition: "+e.error)},e}(),se={onResult:function(e){oe.onresult=function(t){e(t.results[0][0].transcript)}},locale:ie.locale,startFocusListener:function(){ie.start(),window.addEventListener("focus",ie.start)},removeFocusListener:function(){ie.stop(),window.removeEventListener("focus",ie.start)}},ue=function(e){var t=e.date,n=Object(c.useMemo)((function(){return function(e){var t=e.getHours(),n=e.getMinutes(),r=(1-(t%12+n/60)/6)*Math.PI,c=5*Math.sin(r),a=5*Math.cos(r),i=(1-n/30)*Math.PI;return{hourX:c,hourY:a,minutesX:8*Math.sin(i),minutesY:8*Math.cos(i)}}(t)}),[t]),r=n.hourX,a=n.hourY,i=n.minutesX,o=n.minutesY;return Object(l.jsx)("svg",{viewBox:"0 0 24 24",children:Object(l.jsxs)("g",{stroke:"black",strokeWidth:2,strokeLinecap:"round",children:[Object(l.jsx)("circle",{cx:12,cy:12,r:11,fill:"white"}),Object(l.jsx)("line",{x1:12,y1:12,x2:12+r,y2:12+a}),Object(l.jsx)("line",{x1:12,y1:12,x2:12+i,y2:12+o})]})})},le=function(e){var t=e.rate,n=Object(c.useMemo)((function(){return function(e){var t=e%1,n=2*(.5-t)*Math.PI,r=10*Math.sin(n),c=10*Math.cos(n);return{x1:t<.5?r:0,y1:t<.5?c:10,x2:t>=.5?r:0,y2:t>=.5?c:10,colorBg:e<1?"white":"darkgreen",colorRate:e<1?"darkgreen":"red"}}(t)}),[t]),r=n.x1,a=n.y1,i=n.x2,o=n.y2,s=n.colorBg,u=n.colorRate;return Object(l.jsxs)("svg",{viewBox:"0 0 24 24",children:[Object(l.jsx)("g",{stroke:"black",strokeWidth:2,strokeLinecap:"round",children:Object(l.jsx)("circle",{cx:12,cy:12,r:11,fill:s,stroke:"black",strokeWidth:2})}),Object(l.jsx)("path",{d:"M12 12L12 2A10 10 0 0 1 ".concat(12+r," ").concat(12+a,"z"),fill:u}),Object(l.jsx)("path",{d:"M12 12L12 22A10 10 0 0 1 ".concat(12+i," ").concat(12+o,"z"),fill:u})]})};!function(e){e.UNKNOWN="unknown",e.PAUSE="pause",e.END="end"}(ae||(ae={}));var fe=function(e){var t=e.split(" ")[0].toLowerCase();return t===ae.PAUSE?{code:ae.PAUSE,color:"#165180"}:t===ae.END?{code:ae.END,color:"#165180"}:{code:ae.UNKNOWN,color:"none"}},de=function(e){return Object(c.useMemo)((function(){var t=e.map((function(t,n){t.ID;var r,c=t.time,a=(t.description,null===(r=e[n+1])||void 0===r?void 0:r.time);return a?+a-+c:void 0})),n=e.map((function(e){var t=e.description;return fe(t)})),r=e.reduce((function(t,r,c){var a,i=null===(a=e[c+1])||void 0===a?void 0:a.time;return n[c].code===ae.PAUSE&&i?t+(+i-+r.time):t}),0),c=e.length>1?+e[e.length-1].time-+e[0].time-r:void 0,a=0,i=e.map((function(t,r){var c,i=t.time,o=null===(c=e[r+1])||void 0===c?void 0:c.time;return n[r].code===ae.PAUSE&&o&&(a+=+o-+i),a})),o=e.map((function(t,r){var c;t.ID,t.time,t.description;if(n[r].code!==ae.PAUSE){var a=e[0].time,o=null===(c=e[r+1])||void 0===c?void 0:c.time;return o?ce.toRate(+o-+a-+i[r]):void 0}}));return{tracks:e,trackDiffs:t,categories:n,totalTimeMs:c,trackRates:o}}),[e])},je=function(e){var t=e.extendedTracks,n=t.tracks,r=t.trackDiffs,i=t.trackRates,o=t.categories,s=e.onDelete,u=Object(c.useCallback)((function(e){return function(){null===s||void 0===s||s(e)}}),[s]);return Object(l.jsx)("div",{className:"tracks",children:n.map((function(e,t){var n=e.ID,c=e.time,f=e.description,j=i[t],b=r[t];return Object(l.jsxs)(a.a.Fragment,{children:[Object(l.jsxs)("strong",{className:"track__time",children:[Object(l.jsx)(ue,{date:c}),c.toLocaleTimeString()]}),Object(l.jsx)("em",{className:"track__description",style:{backgroundColor:o[t].color},children:f}),Object(l.jsx)("div",{className:"track__rate",children:j&&Object(l.jsx)(le,{rate:j})}),Object(l.jsx)("div",{className:"track__diff",children:b&&ce.toReadableTimeDiff(b)}),Object(l.jsx)("div",{className:"track__actions",children:s&&Object(l.jsx)("button",{onClick:u(n),className:"icon-button delete",title:"delete",children:Object(l.jsx)(d,{})})})]},n)}))})},be=function(){var e=Object(c.useState)([]),t=Object(s.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!1),i=Object(s.a)(a,2),o=i[0],u=i[1],f=Object(c.useState)(!1),d=Object(s.a)(f,2),j=d[0],h=d[1],v=Object(c.useRef)(0),x=Object(c.useMemo)((function(){return(new Date).toLocaleDateString()}),[]),O=Object(c.useCallback)((function(){window.clearTimeout(v.current),h(!0),v.current=window.setTimeout((function(){h(!1)}),5e3)}),[]),k=Object(c.useCallback)((function(){u(!0),O(),se.startFocusListener()}),[O]),m=Object(c.useCallback)((function(){u(!1),se.removeFocusListener()}),[]),w=Object(c.useCallback)((function(e){var t=g.uuid(),n=new Date,c={ID:t,description:e,time:n};ce.current().create(c).then((function(){r((function(e){return e.concat(c)})),h(!1),fe(e).code===ae.END&&m()}))}),[m]);Object(c.useEffect)((function(){se.onResult(w)}),[w]),Object(c.useEffect)((function(){ce.current().current().then(r)}),[k]),Object(c.useEffect)((function(){return window.addEventListener("focus",O),function(){return window.removeEventListener("focus",O)}}),[O]);var y=Object(c.useCallback)((function(e){ce.current().remove(e).then((function(){return r((function(t){return t.filter((function(t){return t.ID!==e}))}))}))}),[]),S=de(n),E=S.totalTimeMs;return Object(l.jsxs)("main",{children:[Object(l.jsxs)("h2",{children:[Object(l.jsx)("span",{children:x}),E&&Object(l.jsxs)("span",{className:"subtitle",children:["Total: ",ce.toReadableTimeDiff(E)]})]}),Object(l.jsx)(je,{extendedTracks:S,onDelete:y}),o?Object(l.jsxs)("div",{className:g.classNames("microphone microphone--stop",j&&"microphone--recording"),children:[Object(l.jsx)("p",{children:"Stop automatically starting recordings."}),Object(l.jsx)("button",{className:"icon-button",onClick:m,children:Object(l.jsx)(p,{})})]}):Object(l.jsxs)("div",{className:"microphone microphone--start",children:[Object(l.jsxs)("p",{children:[n.length?"Continue":"Start a new"," session by clicking on the Microphone."]}),Object(l.jsx)("button",{className:"icon-button",onClick:k,children:Object(l.jsx)(b,{})})]})]})},pe=function(e){var t=e.value,n=e.label;return Object(l.jsx)("option",{value:t,children:n})},he=function(e){var t=e.value,n=e.onChange,r=e.options,a=Object(c.useCallback)((function(e){var t;n(null===(t=r[e.target.value])||void 0===t?void 0:t.value)}),[r,n]),i=Object(c.useMemo)((function(){return r.findIndex((function(e){return e.value===t}))}),[t,r]);return Object(l.jsx)("select",{onChange:a,value:i,children:r.map((function(e,t){return Object(l.jsx)(pe,{label:e.label,value:t},t)}))})},ve=[{label:"Browser Local Storage",value:r.LOCAL},{label:"File System Workdir",value:r.FILE_SYSTEM}],xe=function(e){var t=e.open,n=e.onClose,c=_((function(e){return e.trackType||r.LOCAL}));return Object(l.jsxs)("div",{className:"settings"+(t?" settings--open":""),children:[Object(l.jsx)("h2",{children:"Settings"}),Object(l.jsx)("button",{className:"settings__close icon-button",onClick:n,title:"close settings",children:Object(l.jsx)(v,{})}),Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"Language: "}),se.locale," ",Object(l.jsx)("em",{children:"(configure your Browser language to change this value)"})]}),Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"Storage: "}),Object(l.jsx)(he,{onChange:ce.change,options:ve,value:c})]}),Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"Work per day: "}),"8h ",Object(l.jsx)("em",{children:"(not yet configurable)"})]}),Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"Speech Recognition Trigger: "}),"Tab Focus ",Object(l.jsx)("em",{children:"(not yet configurable)"})]}),Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"Pause Command: "}),'"Pause" [#165180] ',Object(l.jsx)("em",{children:"(not yet configurable)"})]}),Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"End Command: "}),'"End" [#165180] ',Object(l.jsx)("em",{children:"(not yet configurable)"})]})]})},Oe=function(e){var t=e.tracks,n=de(t),r=n.totalTimeMs;return Object(l.jsxs)("details",{children:[Object(l.jsx)("summary",{children:Object(l.jsxs)("span",{className:"summary-title",children:[Object(l.jsx)("span",{children:t[0].time.toLocaleDateString()}),r&&Object(l.jsxs)("span",{className:"summary-subtitle",children:["Total: ",ce.toReadableTimeDiff(r)]})]})}),Object(l.jsx)(je,{extendedTracks:n})]})},ke=function(){var e=Object(c.useState)([]),t=Object(s.a)(e,2),n=t[0],r=t[1];return Object(c.useEffect)((function(){ce.current().getLatest().then(r)}),[]),Object(l.jsx)("aside",{children:n.map((function(e,t){return Object(l.jsx)(Oe,{tracks:e},t)}))})},me=function(){var e=Object(c.useState)(!1),t=Object(s.a)(e,2),n=t[0],a=t[1],i=Object(c.useCallback)((function(){return a(!0)}),[]),o=Object(c.useCallback)((function(){return a(!1)}),[]),u=_((function(e){return{workdirAccessGranted:e.workdirAccessGranted,trackType:e.trackType,workdirName:e.workdirName,currentKey:e.currentKey}})),f=u.workdirAccessGranted,d=u.trackType,b=u.workdirName,p=u.currentKey;return Object(c.useEffect)((function(){ce.init()}),[]),Object(l.jsxs)("div",{className:"App",children:[Object(l.jsxs)("header",{children:[Object(l.jsxs)("h1",{children:[Object(l.jsx)("img",{src:"/trackuler/favicon.svg",alt:"logo",height:24,width:24})," Trackuler"]}),Object(l.jsx)("button",{className:"icon-button",onClick:i,title:"settings",children:Object(l.jsx)(h,{})})]}),Object(l.jsx)(xe,{open:n,onClose:o}),d?d!==r.FILE_SYSTEM||f?Object(l.jsxs)("div",{className:"content",children:[Object(l.jsx)(be,{}),Object(l.jsx)(ke,{})]}):Object(l.jsxs)("div",{className:"workdir-access",children:[Object(l.jsxs)("p",{children:['Grant read & write access to workdir: "',b,'"']}),Object(l.jsx)("button",{className:"icon-button",onClick:Z.init,children:Object(l.jsx)(j,{})})]}):null]},p)};o.a.render(Object(l.jsx)(a.a.StrictMode,{children:Object(l.jsx)(me,{})}),document.getElementById("root"))}},[[20,1,2]]]);