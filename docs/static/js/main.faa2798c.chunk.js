(this["webpackJsonpTrackula-Frontend"]=this["webpackJsonpTrackula-Frontend"]||[]).push([[0],{17:function(e){e.exports=JSON.parse('{"DELETE":"M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z","EDIT":"M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z","FOLDER_OPEN":"M572.694 292.093L500.27 416.248A63.997 63.997 0 0 1 444.989 448H45.025c-18.523 0-30.064-20.093-20.731-36.093l72.424-124.155A64 64 0 0 1 152 256h399.964c18.523 0 30.064 20.093 20.73 36.093zM152 224h328v-48c0-26.51-21.49-48-48-48H272l-64-64H48C21.49 64 0 85.49 0 112v278.046l69.077-118.418C86.214 242.25 117.989 224 152 224z","MICROPHONE":"M176 352c53.02 0 96-42.98 96-96V96c0-53.02-42.98-96-96-96S80 42.98 80 96v160c0 53.02 42.98 96 96 96zm160-160h-16c-8.84 0-16 7.16-16 16v48c0 74.8-64.49 134.82-140.79 127.38C96.71 376.89 48 317.11 48 250.3V208c0-8.84-7.16-16-16-16H16c-8.84 0-16 7.16-16 16v40.16c0 89.64 63.97 169.55 152 181.69V464H96c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16h-56v-33.77C285.71 418.47 352 344.9 352 256v-48c0-8.84-7.16-16-16-16z","MICROPHONE_SLASH":"M633.82 458.1l-157.8-121.96C488.61 312.13 496 285.01 496 256v-48c0-8.84-7.16-16-16-16h-16c-8.84 0-16 7.16-16 16v48c0 17.92-3.96 34.8-10.72 50.2l-26.55-20.52c3.1-9.4 5.28-19.22 5.28-29.67V96c0-53.02-42.98-96-96-96s-96 42.98-96 96v45.36L45.47 3.37C38.49-2.05 28.43-.8 23.01 6.18L3.37 31.45C-2.05 38.42-.8 48.47 6.18 53.9l588.36 454.73c6.98 5.43 17.03 4.17 22.46-2.81l19.64-25.27c5.41-6.97 4.16-17.02-2.82-22.45zM400 464h-56v-33.77c11.66-1.6 22.85-4.54 33.67-8.31l-50.11-38.73c-6.71.4-13.41.87-20.35.2-55.85-5.45-98.74-48.63-111.18-101.85L144 241.31v6.85c0 89.64 63.97 169.55 152 181.69V464h-56c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16z","PLUS":"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z","SEARCH":"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z","SETTINGS":"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z","SPINNER":"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z","TIMES":"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"}')},21:function(e,t,n){},28:function(e,t,n){"use strict";n.r(t);n(21);var r,c=n(1),a=n.n(c),o=n(10),u=n.n(o),i=n(4),s=n(17),l=n(0),f=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.className,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:512;return Object(l.jsx)("svg",{className:n?n+" icon":"icon",viewBox:"0 0 ".concat(r," 512"),children:Object(l.jsx)("path",{fill:"currentColor",d:s[e]})})},d=function(e){return f("DELETE",e,448)},j=function(e){return f("EDIT",e)},b=function(e){return f("FOLDER_OPEN",e,576)},p=function(e){return f("MICROPHONE",e,352)},h=function(e){return f("MICROPHONE_SLASH",e,640)},v=function(e){return f("PLUS",e,448)},O=function(e){return f("SETTINGS",e)},g=function(e){return f("TIMES",e,352)},x=n(5),m=function(e){return Object(x.a)(Object(x.a)({},e),{},{time:e.time.toISOString()})},k=function(e){return("0"+e).slice(-2)},w=function(e){return!!e&&"string"===typeof e},y={uuid:function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)},convertAPITracks:function(e){return e.map((function(e){return Object(x.a)(Object(x.a)({},e),{},{time:new Date(e.time)})}))},convertTracks:function(e){return e.map(m)},toApiString:function(e){return"".concat(e.getFullYear(),"-").concat(k(e.getMonth()+1),"-").concat(k(e.getDate()))},convertTrack:m,getKeyForDate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return"trackuler-"+y.toApiString(e)},classNames:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(w).join(" ")||void 0}},C=n(2),S=n.n(C),E=n(3);!function(e){e.LOCAL="local",e.API="API",e.FILE_SYSTEM="files"}(r||(r={}));var N,M,L=n(7),D=function(){var e=Object(E.a)(S.a.mark((function e(t){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=L.a.get(t))){e.next=8;break}return e.prev=2,e.abrupt("return",JSON.parse(n));case 6:e.prev=6,e.t0=e.catch(2);case 8:return e.abrupt("return",[]);case 9:case"end":return e.stop()}}),e,null,[[2,6]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){return D(y.getKeyForDate())},I="trackuler-config",A={current:function(){return T().then(y.convertAPITracks)},createOrUpdate:function(){var e=Object(E.a)(S.a.mark((function e(t){var n,r,c,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.convertTrack(t),e.next=3,T();case 3:r=e.sent,c=!0,a=r.map((function(e){return e.ID!==t.ID?e:(c=!1,n)})),c&&a.push(n),L.a.set(y.getKeyForDate(t.time),JSON.stringify(a));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),remove:function(){var e=Object(E.a)(S.a.mark((function e(t){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T();case 2:n=e.sent,L.a.set(y.getKeyForDate(),JSON.stringify(n.filter((function(e){return e.ID!==t}))));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getLatest:function(){var e=y.getKeyForDate();return Promise.all(Object.keys(localStorage).filter((function(t){return t.startsWith("trackuler-2")&&t!==e})).sort().reverse().map((function(e){return D(e).then(y.convertAPITracks)})))},getConfig:function(){var e=Object(E.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=L.a.get(I))){e.next=8;break}return e.prev=2,e.abrupt("return",JSON.parse(t));case 6:e.prev=6,e.t0=e.catch(2);case 8:return e.abrupt("return",{});case 9:case"end":return e.stop()}}),e,null,[[2,6]])})));return function(){return e.apply(this,arguments)}}(),setConfig:function(){var e=Object(E.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",L.a.set(I,JSON.stringify(t)));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},F={current:function(){return fetch("/api/tracks").then((function(e){return e.ok?e.json().then(y.convertAPITracks):[]}))},createOrUpdate:function(e){var t=e.ID,n=e.description,r=e.time;return fetch("/api/track",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({ID:t,description:n,time:r.toISOString()})}).then((function(e){if(!e.ok)throw new Error("Creation failed")}))},remove:function(e){return fetch("/api/track",{method:"delete",headers:{"Content-Type":"application/json"},body:JSON.stringify({ID:e})}).then((function(e){if(!e.ok)throw new Error("Deletion failed")}))},getLatest:function(){return fetch("/api/tracks/latest").then((function(e){return e.ok?e.json().then((function(e){return e.map(y.convertAPITracks)})):[]}))},getConfig:function(){return fetch("/api/config").then((function(e){return e.ok?e.json():{}}))},setConfig:function(e){return fetch("/api/config",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){if(!e.ok)throw new Error("Creation failed")}))}},P=n(18),R=n(15);!function(e){e.DIR="directory",e.FILE="file"}(N||(N={})),function(e){e.READ="read",e.READ_WRITE="readwrite"}(M||(M={}));var H="workdir",z={},W={getWorkdir:function(){var e=Object(E.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(z.workdir){e.next=4;break}return e.next=3,Object(R.b)(H);case 3:z.workdir=e.sent;case 4:return e.abrupt("return",z.workdir);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),setWorkdir:function(e){return z.workdir=e,Object(R.c)(H,e)},removeWorkdir:function(){return z.workdir=void 0,Object(R.a)(H)}},_=n(19),B=Object(_.a)({workdirAccessGranted:!1,workdirName:void 0,trackType:void 0,currentKey:y.getKeyForDate(),language:navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language}),K=Object(i.a)(B,2),U=K[0],J=K[1];var Y={mode:M.READ_WRITE},V=/^trackuler-\d{4}-\d{2}-\d{2}\.json$/,G=function(){return e=new Date,y.getKeyForDate(e)+".json";var e},X=function(){var e=Object(E.a)(S.a.mark((function e(t,n){var r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.createWritable();case 2:return r=e.sent,e.next=5,r.write(n);case 5:return e.next=7,r.close();case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),q=function(){var e=Object(E.a)(S.a.mark((function e(t,n){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X(t,JSON.stringify(n));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),$=function(){var e=Object(E.a)(S.a.mark((function e(t,n){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(t,n.map(y.convertTrack));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Q=function(){var e=Object(E.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,W.getWorkdir();case 3:if(!(t=e.sent)){e.next=14;break}return e.next=7,t.queryPermission(Y);case 7:if(e.t0=e.sent,"granted"!==e.t0){e.next=10;break}return e.abrupt("return",!0);case 10:return e.next=12,t.requestPermission(Y);case 12:return e.t1=e.sent,e.abrupt("return","granted"===e.t1);case 14:e.next=19;break;case 16:e.prev=16,e.t2=e.catch(0),window.console.error(e.t2);case 19:return e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}(),Z=function(e){return e.getFile().then((function(e){return e.text()}))},ee=function(){var e=Object(E.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=y,e.t1=JSON,e.next=4,Z(t);case 4:return e.t2=e.sent,e.t3=e.t1.parse.call(e.t1,e.t2),e.abrupt("return",e.t0.convertAPITracks.call(e.t0,e.t3));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(E.a)(S.a.mark((function e(t){var n,r,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.getWorkdir();case 2:return n=e.sent,e.prev=3,e.next=6,n.getFileHandle(t);case 6:if(!(r=e.sent)){e.next=13;break}return e.t0=r,e.next=11,ee(r);case 11:return e.t1=e.sent,e.abrupt("return",{fileHandle:e.t0,tracks:e.t1});case 13:e.next=18;break;case 15:e.prev=15,e.t2=e.catch(3),e.t2.message.includes("could not be found")||window.console.error(e.t2);case 18:return e.next=20,n.getFileHandle(t,{create:!0});case 20:return c=e.sent,e.next=23,$(c,[]);case 23:return e.abrupt("return",{tracks:[],fileHandle:c});case 24:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),ne=function(){return te(G())},re=function(){var e=Object(E.a)(S.a.mark((function e(){var t,n,r,c,a,o,u,i,s,l,f;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=G(),e.next=3,W.getWorkdir();case 3:n=e.sent,r=[],c=!0,a=!1,e.prev=7,u=Object(P.a)(n.values());case 9:return e.next=11,u.next();case 11:return i=e.sent,c=i.done,e.next=15,i.value;case 15:if(s=e.sent,c){e.next=27;break}if((l=s).kind!==N.FILE){e.next=24;break}if(!V.test(l.name)||l.name===t){e.next=24;break}return e.next=22,ee(l);case 22:(f=e.sent).length&&r.push({entry:l,tracks:f});case 24:c=!0,e.next=9;break;case 27:e.next=33;break;case 29:e.prev=29,e.t0=e.catch(7),a=!0,o=e.t0;case 33:if(e.prev=33,e.prev=34,c||null==u.return){e.next=38;break}return e.next=38,u.return();case 38:if(e.prev=38,!a){e.next=41;break}throw o;case 41:return e.finish(38);case 42:return e.finish(33);case 43:return e.abrupt("return",r.sort((function(e,t){return t.entry.name.localeCompare(e.entry.name)})).map((function(e){return e.tracks})));case 44:case"end":return e.stop()}}),e,null,[[7,29,33,43],[34,,38,42]])})));return function(){return e.apply(this,arguments)}}(),ce=function(){var e=Object(E.a)(S.a.mark((function e(t){var n,r,c,a,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne();case 2:return n=e.sent,r=n.tracks,c=n.fileHandle,a=!0,o=r.map((function(e){return e.ID!==t.ID?e:(a=!1,t)})),a&&o.push(t),e.next=10,$(c,o);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=Object(E.a)(S.a.mark((function e(t){var n,r,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ne();case 2:return n=e.sent,r=n.tracks,c=n.fileHandle,e.next=7,$(c,r.filter((function(e){return e.ID!==t})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),oe="trackuler-config.json",ue=function(){var e=Object(E.a)(S.a.mark((function e(){var t,n,r,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.getWorkdir();case 2:return t=e.sent,e.prev=3,e.next=6,t.getFileHandle(oe);case 6:if(!(n=e.sent)){e.next=15;break}return e.t0=JSON,e.next=11,Z(n);case 11:return e.t1=e.sent,e.t2=e.t0.parse.call(e.t0,e.t1),e.t3=n,e.abrupt("return",{config:e.t2,fileHandle:e.t3});case 15:e.next=20;break;case 17:e.prev=17,e.t4=e.catch(3),e.t4.message.includes("could not be found")||window.console.error(e.t4);case 20:return e.next=22,t.getFileHandle(oe,{create:!0});case 22:return r=e.sent,c={},e.next=26,q(r,c);case 26:return e.abrupt("return",{config:c,fileHandle:r});case 27:case"end":return e.stop()}}),e,null,[[3,17]])})));return function(){return e.apply(this,arguments)}}(),ie={init:function(){return Q().then((function(e){return J.set({workdirAccessGranted:e})}))},getWorkdir:function(){return W.getWorkdir().then((function(e){return null===e||void 0===e?void 0:e.name}))},current:function(){return te(G()).then((function(e){return e.tracks}))},createOrUpdate:ce,remove:ae,getLatest:re,pickWorkdir:function(){return window.showDirectoryPicker().then(function(){var e=Object(E.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W.setWorkdir(t);case 2:return e.abrupt("return",t.name);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch()},unlinkWorkdir:function(){return W.removeWorkdir()},getConfig:function(){var e=Object(E.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ue().then((function(e){return e.config})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),setConfig:function(){var e=Object(E.a)(S.a.mark((function e(t){var n,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue();case 2:return n=e.sent,r=n.fileHandle,e.next=6,q(r,t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},se={current:A},le=function(){return se.current},fe=function(){var e=Object(E.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie.getWorkdir();case 2:if(t=e.sent,J.set({workdirName:t}),!t){e.next=8;break}return e.abrupt("return",r.FILE_SYSTEM);case 8:return e.abrupt("return",r.LOCAL);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),de=function(){var e=Object(E.a)(S.a.mark((function e(t){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t===r.LOCAL?se.current=A:t===r.API?se.current=F:se.current=ie,J.set({trackType:t});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),je=function(){var e=Object(E.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=y.getKeyForDate(),window.addEventListener("focus",(function(){var e=y.getKeyForDate();t!==e&&J.set({currentKey:e})})),e.abrupt("return",fe().then(de));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),be=function(){var e=Object(E.a)(S.a.mark((function e(t){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==r.FILE_SYSTEM){e.next=12;break}return e.next=3,ie.pickWorkdir();case 3:if(!(n=e.sent)){e.next=9;break}J.set({workdirName:n}),se.current=ie,e.next=10;break;case 9:return e.abrupt("return");case 10:e.next=15;break;case 12:if(se.current!==ie){e.next=15;break}return e.next=15,ie.unlinkWorkdir();case 15:return e.next=17,de(t);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=Object(E.a)(S.a.mark((function e(){var t,n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le().getConfig();case 2:t=e.sent,(n=t.language)&&J.set({language:n});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=function(){var e=Object(E.a)(S.a.mark((function e(t){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le().getConfig();case 2:return n=e.sent,e.next=5,le().setConfig(Object(x.a)(Object(x.a)({},n),{},{language:t}));case 5:J.set({language:t});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ve={current:le,change:be,toReadableTimeDiff:function(e){var t=Math.floor(e/1e3),n=Math.floor(t/60),r=Math.floor(n/60),c=n%60,a=t%60,o=[];return r&&o.push(r+"h"),c&&o.push(c+"m"),a&&o.push(a+"s"),o.join(" ")},toRate:function(e){return e/288e5},init:je,loadConfig:pe,setLanguage:he};window.SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition;var Oe,ge={running:!1,start:function(){},stop:function(){}},xe=function(){var e=new SpeechRecognition;return e.continuous=!1,e.interimResults=!1,e.maxAlternatives=1,e.lang=J.get().language,J.listen((function(e){return e.language}),(function(t){e.lang=t})),ge.start=function(){ge.running||(e.start(),ge.running=!0)},ge.stop=function(){ge.running&&e.stop()},e.onend=function(){ge.running=!1},e.onspeechend=function(){ge.stop()},e.onerror=function(e){window.console.error("Error occurred in recognition: "+e.error)},e}(),me=function(e){xe.onresult=function(t){e(t.results[0][0].transcript)}},ke=function(){ge.start(),window.addEventListener("focus",ge.start)},we=function(){ge.stop(),window.removeEventListener("focus",ge.start)};!function(e){e.UNKNOWN="unknown",e.PAUSE="pause",e.END="end"}(Oe||(Oe={}));var ye=function(e){var t=e.split(" ")[0].toLowerCase();return t===Oe.PAUSE?{code:Oe.PAUSE,color:"#165180"}:t===Oe.END?{code:Oe.END,color:"#165180"}:{code:Oe.UNKNOWN,color:"unset"}},Ce=function(e){var t=e.date,n=Object(c.useMemo)((function(){return function(e){var t=e.getHours(),n=e.getMinutes(),r=(1-(t%12+n/60)/6)*Math.PI,c=5*Math.sin(r),a=5*Math.cos(r),o=(1-n/30)*Math.PI;return{hourX:c,hourY:a,minutesX:8*Math.sin(o),minutesY:8*Math.cos(o)}}(t)}),[t]),r=n.hourX,a=n.hourY,o=n.minutesX,u=n.minutesY;return Object(l.jsx)("svg",{viewBox:"0 0 24 24",children:Object(l.jsxs)("g",{stroke:"black",strokeWidth:2,strokeLinecap:"round",children:[Object(l.jsx)("circle",{cx:12,cy:12,r:11,fill:"white"}),Object(l.jsx)("line",{x1:12,y1:12,x2:12+r,y2:12+a}),Object(l.jsx)("line",{x1:12,y1:12,x2:12+o,y2:12+u})]})})},Se=function(e){var t=e.rate,n=Object(c.useMemo)((function(){return function(e){var t=e%1,n=2*(.5-t)*Math.PI,r=10*Math.sin(n),c=10*Math.cos(n);return{x1:t<.5?r:0,y1:t<.5?c:10,x2:t>=.5?r:0,y2:t>=.5?c:10,colorBg:e<1?"white":"darkgreen",colorRate:e<1?"darkgreen":"red"}}(t)}),[t]),r=n.x1,a=n.y1,o=n.x2,u=n.y2,i=n.colorBg,s=n.colorRate;return Object(l.jsxs)("svg",{viewBox:"0 0 24 24",children:[Object(l.jsx)("g",{stroke:"black",strokeWidth:2,strokeLinecap:"round",children:Object(l.jsx)("circle",{cx:12,cy:12,r:11,fill:i,stroke:"black",strokeWidth:2})}),Object(l.jsx)("path",{d:"M12 12L12 2A10 10 0 0 1 ".concat(12+r," ").concat(12+a,"z"),fill:s}),Object(l.jsx)("path",{d:"M12 12L12 22A10 10 0 0 1 ".concat(12+o," ").concat(12+u,"z"),fill:s})]})},Ee=n(12),Ne=n(20),Me=n(9),Le=["onChange","onBlur"],De=["Field"],Te=["value","onChange","onBlur"],Ie=["Field"],Ae=function(e){var t=e.onChange,n=e.onBlur,r=Object(Me.a)(e,Le),a=Object(c.useCallback)((function(e){return t(e.target.value)}),[t]),o=Object(c.useMemo)((function(){return n?function(e){return n(e.target.value)}:void 0}),[n]);return Object(l.jsx)("input",Object(x.a)({onChange:a,onBlur:o},r))},Fe=function(e){var t=e.Field,n=Object(Me.a)(e,De);return Object(l.jsx)(t,{children:function(e){var t=e.onChange,r=e.value;return Object(l.jsx)(Ae,Object(x.a)({onChange:t,value:r},n))}})},Pe=function(e,t){var n=e.split(":").map(Number);return Object(Ee.a)(Date,[t.getFullYear(),t.getMonth(),t.getDate()].concat(Object(Ne.a)(n)))},Re=function(e){var t=e.value,n=e.onChange,r=e.onBlur,a=Object(Me.a)(e,Te),o=Object(c.useCallback)((function(e){return n(Pe(e,t))}),[n,t]),u=Object(c.useMemo)((function(){return r?function(e){return r(Pe(e,t))}:void 0}),[r,t]);return Object(l.jsx)(Ae,Object(x.a)({value:t.toLocaleTimeString(),onChange:o,onBlur:u,step:2,type:"time"},a))},He=function(e){var t=e.Field,n=Object(Me.a)(e,Ie);return Object(l.jsx)(t,{children:function(e){var t=e.onChange,r=e.value;return Object(l.jsx)(Re,Object(x.a)({onChange:t,value:r},n))}})},ze=n(14),We=ze.a.create({time:new Date}),_e=We.Fields,Be=We.Form,Ke=function(e){var t=e.time,n=e.onChange,r=Object(c.useState)({values:{time:t},errors:{}}),a=Object(i.a)(r,2),o=a[0],u=a[1],s=Object(c.useCallback)((function(e){var t=e.time;return n(t)}),[n]);return Object(l.jsxs)(Be,{onChange:u,data:o,onSubmit:s,validation:{},children:[Object(l.jsx)(He,{autoFocus:!0,onBlur:n,Field:_e.time}),Object(l.jsx)("button",{style:{display:"none"}})]})},Ue=function(e){var t=e.time;return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(Ce,{date:t}),t.toLocaleTimeString()]})},Je=function(e){var t=e.time,n=e.onChange,r=Object(c.useState)(!1),a=Object(i.a)(r,2),o=a[0],u=a[1],s=Object(c.useCallback)((function(){return u(!0)}),[]),f=Object(c.useCallback)((function(e){return n(e).then((function(){return u(!1)}))}),[n]);return Object(l.jsx)("strong",{className:"track__time",onClick:s,role:o?void 0:"button",children:o?Object(l.jsx)(Ke,{time:t,onChange:f}):Object(l.jsx)(Ue,{time:t})})},Ye=function(e){var t=e.time,n=e.onChange;return n?Object(l.jsx)(Je,{time:t,onChange:n}):Object(l.jsx)("strong",{className:"track__time",children:Object(l.jsx)(Ue,{time:t})})},Ve=ze.a.create({description:""}),Ge=Ve.Fields,Xe=Ve.Form,qe={description:{onChange:function(e){return e?void 0:{id:"At least one character required"}}}},$e=function(e){var t=e.description,n=void 0===t?"":t,r=e.onChange,a=e.submitOnBlur,o=Object(c.useRef)({values:{description:n},errors:{}}),u=function(e){var t=Object(c.useState)(e),n=Object(i.a)(t,2),r=n[0],a=n[1],o=Object(c.useRef)(!0);return Object(c.useEffect)((function(){return function(){o.current=!1}}),[]),[r,Object(c.useCallback)((function(e){o.current&&a(e)}),[])]}(o.current),s=Object(i.a)(u,2),f=s[0],d=s[1],j=Object(c.useCallback)((function(e){var t=e.description;return r(t).then((function(){return d(o.current)}))}),[r,d]),b=Object(c.useCallback)((function(e){return a&&e&&j({description:e})}),[j,a]);return Object(l.jsxs)(Xe,{onChange:d,data:f,onSubmit:j,validation:qe,children:[Object(l.jsx)(Fe,{autoFocus:!0,onBlur:b,Field:Ge.description}),Object(l.jsx)("button",{style:{display:"none"}})]})},Qe=function(e){var t=e.value,n=e.onChange,r=e.color,a=Object(c.useState)(!1),o=Object(i.a)(a,2),u=o[0],s=o[1],f=Object(c.useCallback)((function(){return s(!0)}),[]),d=Object(c.useCallback)((function(e){return n(e).then((function(){return s(!1)}))}),[n]);return Object(l.jsx)("div",{className:"track__description",style:{backgroundColor:r},children:u?Object(l.jsx)($e,{description:t,onChange:d,submitOnBlur:!0}):Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("em",{children:t}),Object(l.jsx)("button",{onClick:f,className:"icon-button",title:"edit",children:Object(l.jsx)(j,{})})]})})},Ze=function(e){var t=e.value,n=e.onChange,r=e.color;return n?Object(l.jsx)(Qe,{value:t,onChange:n,color:r}):Object(l.jsx)("div",{className:"track__description",style:{backgroundColor:r},children:Object(l.jsx)("em",{children:t})})},et=function(e){var t=e.track,n=t.time,r=t.description,a=t.ID,o=e.track,u=e.onDelete,i=e.onChange,s=e.category.color,f=e.rate,j=e.diff,b=Object(c.useMemo)((function(){return u?function(){return u(a)}:void 0}),[u,a]),p=Object(c.useMemo)((function(){return i?function(e){return i(Object(x.a)(Object(x.a)({},o),{},{time:e}))}:void 0}),[i,o]),h=Object(c.useMemo)((function(){return i?function(e){return i(Object(x.a)(Object(x.a)({},o),{},{description:e}))}:void 0}),[i,o]);return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(Ye,{time:n,onChange:p}),Object(l.jsx)(Ze,{value:r,color:s,onChange:h}),Object(l.jsx)("div",{className:"track__rate",title:f?Math.floor(100*f)+"%":void 0,children:f&&Object(l.jsx)(Se,{rate:f})}),Object(l.jsx)("div",{className:"track__diff",children:j&&ve.toReadableTimeDiff(j)}),Object(l.jsx)("div",{className:"track__actions",children:b&&Object(l.jsx)("button",{onClick:b,className:"icon-button delete",title:"delete",children:Object(l.jsx)(d,{})})})]})},tt=function(e){return Object(c.useMemo)((function(){var t=e.sort((function(e,t){return+e.time-+t.time})),n=t.map((function(e,n){e.ID;var r,c=e.time,a=(e.description,null===(r=t[n+1])||void 0===r?void 0:r.time);return a?+a-+c:void 0})),r=t.map((function(e){var t=e.description;return ye(t)})),c=t.reduce((function(e,n,c){var a,o=null===(a=t[c+1])||void 0===a?void 0:a.time;return r[c].code===Oe.PAUSE&&o?e+(+o-+n.time):e}),0),a=t.length>1?+t[t.length-1].time-+t[0].time-c:void 0,o=0,u=t.map((function(e,n){var c,a=e.time,u=null===(c=t[n+1])||void 0===c?void 0:c.time;return r[n].code===Oe.PAUSE&&u&&(o+=+u-+a),o})),i=t.map((function(e,n){var c;e.ID,e.time,e.description;if(r[n].code!==Oe.PAUSE){var a=t[0].time,o=null===(c=t[n+1])||void 0===c?void 0:c.time;return o?ve.toRate(+o-+a-+u[n]):void 0}}));return{tracks:t,trackDiffs:n,categories:r,totalTimeMs:a,trackRates:i}}),[e])},nt=function(e){var t=e.extendedTracks,n=t.tracks,r=t.trackDiffs,c=t.trackRates,a=t.categories,o=e.onDelete,u=e.onChange;return Object(l.jsx)("div",{className:"tracks",children:n.map((function(e,t){return Object(l.jsx)(et,{track:e,category:a[t],rate:c[t],diff:r[t],onDelete:o,onChange:u},e.ID)}))})},rt=function(){var e=Object(c.useState)([]),t=Object(i.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!1),o=Object(i.a)(a,2),u=o[0],s=o[1],f=Object(c.useState)(!1),d=Object(i.a)(f,2),j=d[0],b=d[1],O=Object(c.useRef)(0),g=Object(c.useMemo)((function(){return(new Date).toLocaleDateString()}),[]);Object(c.useEffect)((function(){ve.loadConfig()}),[]);var x=Object(c.useCallback)((function(){var e;null===(e=document.getElementsByTagName("input")[0])||void 0===e||e.focus(),window.clearTimeout(O.current),b(!0),O.current=window.setTimeout((function(){b(!1)}),5e3)}),[]),m=Object(c.useCallback)((function(){s(!0),x(),ke()}),[x]),k=Object(c.useCallback)((function(){s(!1),we()}),[]),w=Object(c.useCallback)((function(e){var t=y.uuid(),n=new Date,c={ID:t,description:e,time:n};return ve.current().createOrUpdate(c).then((function(){!function(){var e=document.getElementById("logo-img");e.classList.add("rotate"),window.setTimeout((function(){e.classList.remove("rotate")}),500)}(),r((function(e){return e.concat(c)})),b(!1),ye(e).code===Oe.END&&k()}))}),[k]);Object(c.useEffect)((function(){me(w)}),[w]),Object(c.useEffect)((function(){ve.current().current().then(r)}),[m]),Object(c.useEffect)((function(){return window.addEventListener("focus",x),function(){return window.removeEventListener("focus",x)}}),[x]);var C=Object(c.useCallback)((function(e){return ve.current().remove(e).then((function(){return r((function(t){return t.filter((function(t){return t.ID!==e}))}))}))}),[]),S=Object(c.useCallback)((function(e){return ve.current().createOrUpdate(e).then((function(){return r((function(t){return t.map((function(t){return t.ID===e.ID?e:t}))}))}))}),[]),E=tt(n),N=E.totalTimeMs;return Object(l.jsxs)("main",{children:[Object(l.jsxs)("h2",{children:[Object(l.jsx)("span",{children:g}),N&&Object(l.jsxs)("span",{className:"subtitle",children:["Total: ",ve.toReadableTimeDiff(N)]})]}),Object(l.jsx)(nt,{extendedTracks:E,onDelete:C,onChange:S}),Object(l.jsxs)("div",{className:"add-track",children:[Object(l.jsx)(v,{}),Object(l.jsx)($e,{onChange:w})]}),u?Object(l.jsxs)("div",{className:y.classNames("microphone microphone--stop",j&&"microphone--recording"),children:[Object(l.jsx)("p",{children:"Stop automatically starting recordings."}),Object(l.jsx)("button",{className:"icon-button",onClick:k,children:Object(l.jsx)(h,{})})]}):Object(l.jsxs)("div",{className:"microphone microphone--start",children:[Object(l.jsxs)("p",{children:[n.length?"Continue":"Start a new"," session by clicking on the Microphone."]}),Object(l.jsx)("button",{className:"icon-button",onClick:m,children:Object(l.jsx)(p,{})})]})]})},ct=function(e){var t=e.value,n=e.label;return Object(l.jsx)("option",{value:t,children:n})},at=function(e){var t=e.value,n=e.onChange,r=e.options,a=Object(c.useCallback)((function(e){var t;n(null===(t=r[e.target.value])||void 0===t?void 0:t.value)}),[r,n]),o=Object(c.useMemo)((function(){return r.findIndex((function(e){return e.value===t}))}),[t,r]);return Object(l.jsx)("select",{onChange:a,value:o,children:r.map((function(e,t){return Object(l.jsx)(ct,{label:e.label,value:t},t)}))})},ot=[{label:"Browser Local Storage",value:r.LOCAL},{label:"File System Workdir",value:r.FILE_SYSTEM}],ut=function(e){var t=e.open,n=e.onClose,a=U((function(e){var t=e.trackType,n=e.language,c=e.workdirAccessGranted;return{trackType:t||r.LOCAL,language:n,needsWorkdirAccess:t===r.FILE_SYSTEM&&!c}})),o=a.trackType,u=a.language,i=a.needsWorkdirAccess,s=Object(c.useMemo)((function(){return navigator.languages.map((function(e){return{label:e,value:e}}))}),[]);return Object(l.jsxs)("div",{className:"settings"+(t?" settings--open":""),children:[Object(l.jsx)("h2",{children:"Settings"}),Object(l.jsx)("button",{className:"settings__close icon-button",onClick:n,title:"close settings",children:Object(l.jsx)(g,{})}),Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"Storage: "}),Object(l.jsx)(at,{onChange:ve.change,options:ot,value:o})]}),i?Object(l.jsx)("p",{children:"You need to grant workdir access in order to change further configurations or choose an alternative storage option"}):Object(l.jsx)(l.Fragment,{children:Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"Language: "}),Object(l.jsx)(at,{onChange:ve.setLanguage,options:s,value:u}),Object(l.jsx)("em",{children:" (you can only select languages configured in your browser)"})]})}),Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"Work per day: "}),"8h ",Object(l.jsx)("em",{children:"(not yet configurable)"})]}),Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"Speech Recognition Trigger: "}),"Tab Focus ",Object(l.jsx)("em",{children:"(not yet configurable)"})]}),Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"Pause Command: "}),'"Pause" [#165180] ',Object(l.jsx)("em",{children:"(not yet configurable)"})]}),Object(l.jsxs)("p",{children:[Object(l.jsx)("strong",{children:"End Command: "}),'"End" [#165180] ',Object(l.jsx)("em",{children:"(not yet configurable)"})]})]})},it=function(e){var t=e.tracks,n=tt(t),r=n.totalTimeMs;return Object(l.jsxs)("details",{children:[Object(l.jsx)("summary",{children:Object(l.jsxs)("span",{className:"summary-title",children:[Object(l.jsx)("span",{children:t[0].time.toLocaleDateString()}),r&&Object(l.jsxs)("span",{className:"summary-subtitle",children:["Total: ",ve.toReadableTimeDiff(r)]})]})}),Object(l.jsx)(nt,{extendedTracks:n})]})},st=function(){var e=Object(c.useState)([]),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(c.useEffect)((function(){ve.current().getLatest().then(r)}),[]),Object(l.jsx)("aside",{children:n.map((function(e,t){return Object(l.jsx)(it,{tracks:e},t)}))})},lt=function(){var e=Object(c.useState)(!1),t=Object(i.a)(e,2),n=t[0],a=t[1],o=Object(c.useCallback)((function(){return a(!0)}),[]),u=Object(c.useCallback)((function(){return a(!1)}),[]),s=U((function(e){return{workdirAccessGranted:e.workdirAccessGranted,trackType:e.trackType,workdirName:e.workdirName,currentKey:e.currentKey}})),f=s.workdirAccessGranted,d=s.trackType,j=s.workdirName,p=s.currentKey;return Object(c.useEffect)((function(){ve.init()}),[]),Object(l.jsxs)("div",{className:"App",children:[Object(l.jsxs)("header",{children:[Object(l.jsxs)("h1",{children:[Object(l.jsx)("img",{id:"logo-img",src:"/trackuler/favicon.svg",alt:"logo",height:24,width:24})," ","Trackuler"]}),Object(l.jsx)("button",{className:"icon-button",onClick:o,title:"settings",children:Object(l.jsx)(O,{})})]}),Object(l.jsx)(ut,{open:n,onClose:u}),d?d!==r.FILE_SYSTEM||f?Object(l.jsxs)("div",{className:"content",children:[Object(l.jsx)(rt,{}),Object(l.jsx)(st,{})]}):Object(l.jsxs)("div",{className:"workdir-access",children:[Object(l.jsxs)("p",{children:['Grant read & write access to workdir: "',j,'"']}),Object(l.jsx)("button",{className:"icon-button",onClick:ie.init,children:Object(l.jsx)(b,{})})]}):null]},p)};u.a.render(Object(l.jsx)(a.a.StrictMode,{children:Object(l.jsx)(lt,{})}),document.getElementById("root"))}},[[28,1,2]]]);